互联网化疗
======

> LCTT 译注：本文作者 janit0r 被认为是 BrickerBot 病毒的作者。此病毒会攻击物联网上安全性不足的设备并使其断开和其他网络设备的连接。janit0r 宣称他使用这个病毒的目的是保护互联网的安全，避免这些设备被入侵者用于入侵网络上的其他设备。janit0r 称此项目为“互联网化疗”。janit0r 决定在 2017 年 12 月终止这个项目，并在网络上发表了这篇文章。

> —— 12/10 2017

### --[ 1 互联网化疗

<ruby>互联网化疗<rt>Internet Chemotherapy</rt></ruby>是在 2016 年 11 月 到 2017 年 12 月之间的一个为期 13 个月的项目。它曾被称为 “BrickerBot”、“错误的固件升级”、“勒索软件”、“大规模网络瘫痪”，甚至 “前所未有的恐怖行为”。最后一个有点伤人了，费尔南德斯（LCTT 译注：委内瑞拉电信公司 CANTV 的光纤网络曾在 2017 年 8 月受到病毒攻击，公司董事长曼努埃尔·费尔南德斯称这次攻击为[“前所未有的恐怖行为”][1]），但我想我大概不能让所有人都满意吧。

你可以从 http://91.215.104.140/mod_plaintext.py 下载我的代码模块，它可以基于 http 和 telnet 发送恶意请求（LCTT 译注：这个链接已经失效，不过在 [Github][2] 上有备份）。因为平台的限制，模块里是代码混淆过的单线程 Python 代码，但<ruby>载荷<rt>payload</rd></ruby>（LCTT 译注：payload，指实质的攻击/利用代码）依然是明文，任何合格的程序员应该都能看得懂。看看这里面有多少载荷、0-day 漏洞和入侵技巧，花点时间让自己接受现实。然后想象一下，如果我是一个黑客，致力于创造出强大的 DDoS 生成器来勒索那些最大的互联网服务提供商（ISP）和公司的话，互联网在 2017 年会受到怎样的打击。我完全可以让他们全部陷入混乱，并同时对整个互联网造成巨大的伤害。

我的 ssh 爬虫太危险了，不能发布出来。它包含很多层面的自动化，可以只利用一个被入侵的路由器就能够在设计有缺陷的 ISP 的网络上平行移动并加以入侵。正是因为我可以征用数以万计的 ISP 的路由器，而这些路由器让我知晓网络上发生的事情并给我提供源源不断的节点用来进行入侵行动，我才得以进行我的反物联网僵尸网络项目。我于 2015 年开始了我的非破坏性的 ISP 的网络清理项目，于是当 Mirai 病毒入侵时我已经做好了准备来做出回应。主动破坏其他人的设备仍然是一个困难的决定，但无比危险的 CVE-2016-10372 漏洞让我别无选择。从那时起我就决定一不做二不休。

（LCTT 译注：上一段中提到的 Mirai 病毒首次出现在 2016 年 8 月。它可以远程入侵运行 Linux 系统的网络设备并利用这些设备构建僵尸网络。本文作者 janit0r 宣称当 Mirai 入侵时他利用自己的 BrickerBot 病毒强制将数以万计的设备从网络上断开，从而减少 Mirai 病毒可以利用的设备数量。）

我在此警告你们，我所做的只是权宜之计，它并不足以在未来继续拯救互联网。坏人们正变得更加聪明，潜在存在漏洞的设备数量在持续增加，发生大规模的、能使网络瘫痪的事件只是时间问题。如果你愿意相信，我曾经在一个持续 13 个月的项目中使上千万有漏洞的设备变得无法使用，那么不过分地说，如此严重的事件本已经在 2017 年发生了。

__你们应该意识到，只需要再有一两个严重的物联网漏洞，我们的网络就会严重瘫痪。__ 考虑到我们的社会现在是多么依赖数字网络，而计算机安全应急响应组（CERT）、ISP 们和政府们又是多么地忽视这种问题的严重性，这种事件造成的伤害是无法估计的。ISP 在持续地部署暴露了控制端口的设备，而且即使像 Shodan 这样的服务可以轻而易举地发现这些问题，国家 CERT 还是似乎并不在意。而很多国家甚至都没有自己的 CERT 。世界上许多最大的 ISP 都没有雇佣任何熟知计算机安全问题的人，而是在出现问题的时候依赖于外来的专家来解决。我曾见识过大型 ISP 在我的僵尸网络的调节之下连续多个月持续受损，但他们还是不能完全解决漏洞（几个好的例子是 BSNL、Telkom ZA、PLDT、某些时候的 PT Telkom，以及南半球大部分的大型 ISP ）。只要看看 Telkom ZA 解决他们的 Aztech 调制解调器问题的速度有多慢，你就会开始理解现状有多么令人绝望。在 99% 的情况下，要解决这个问题只需要 ISP 部署合理的访问控制列表，并把部署在用户端的设备（CPE）单独分段就行，但是几个月过去之后他们的技术人员依然没有弄明白。如果 ISP 在经历了几周到几个月的针对他们设备的蓄意攻击之后仍然无法解决问题，我们又怎么能期望他们会注意到并解决 Mirai 在他们网络上造成的问题呢？世界上许多最大的 ISP 对这些事情无知得令人发指，而这毫无疑问是最大的危险，但奇怪的是，这应该也是最容易解决的问题。

我已经尽自己的责任试着去让互联网多坚持一段时间，但我已经尽力了。接下来要交给你们了。即使很小的行动也是非常重要的。你们能做的事情有：

* 使用像 Shodan 之类的服务来检查你的 ISP 的安全性，并驱使他们去解决他们网络上开放的 telnet、http、httpd、ssh 和 tr069 等端口。如果需要的话，可以把这篇文章给他们看。从来不存在什么好的理由来让这些端口可以从外界访问。暴露控制端口是业余人士的错误。如果有足够的客户抱怨，他们也许真的会采取行动！
* 用你的钱包投票！拒绝购买或使用任何“智能”产品，除非制造商保证这个产品能够而且将会收到及时的安全更新。在把你辛苦赚的钱交给提供商之前，先去查看他们的安全记录。为了更好的安全性，可以多花一些钱。
* 游说你本地的政治家和政府官员，让他们改进法案来规范物联网设备，包括路由器、IP 照相机和各种“智能”设备。不论私有还是公有的公司目前都没有足够的动机去在短期内解决该问题。这件事情和汽车或者通用电器的安全标准一样重要。
* 考虑给像 GDI 基金会或者 Shadowserver 基金会这种缺少支持的白帽黑客组织贡献你的时间或者其他资源。这些组织和人能产生巨大的影响，并且他们可以很好地发挥你的能力来帮助互联网。
* 最后，虽然希望不大，但可以考虑通过设立法律先例来让物联网设备成为一种“<ruby>诱惑性危险品<rt>attractive nuisance</rt></ruby>”（LCTT 译注：attractive nuisance 是美国法律中的一个原则，意思是如果儿童在私人领地上因为某些对儿童有吸引力的危险物品而受伤，领地的主人需要负责，无论受伤的儿童是否是合法进入领地）。如果一个房主可以因为小偷或者侵入者受伤而被追责，我不清楚为什么设备的主人（或者 ISP 和设备制造商）不应该因为他们的危险的设备被远程入侵所造成的伤害而被追责。连带责任原则应该适用于对设备应用层的入侵。如果任何有钱的大型 ISP 不愿意为设立这样的先例而出钱（他们也许的确不会，因为他们害怕这样的先例会反过来让自己吃亏），我们甚至可以在这里还有在欧洲为这个行动而进行众筹。 ISP 们：把你们在用来应对 DDoS 的带宽上省下的可观的成本当做我为这个目标的间接投资，也当做它的好处的证明吧。

### --[ 2 时间线

下面是这个项目中一些值得纪念的事件：

* 2016 年 11 月底的德国电信 Mirai 事故。我匆忙写出的最初的 TR069/64 请求只执行了 `route del default`，不过这已经足够引起 ISP 去注意这个问题，而它引发的新闻头条警告了全球的其他 ISP 来注意这个迫近的危机。
* 大约 1 月 11 日 到 12 日，一些位于华盛顿特区的开放了 6789 控制端口的硬盘录像机被 Mirai 入侵并瘫痪，这上了很多头条新闻。我要给 Vemulapalli 点赞，她居然认为 Mirai 加上 `/dev/urandom` 一定是“非常复杂的勒索软件”（LCTT 译注：Archana Vemulapalli 当时是华盛顿市政府的 CTO）。欧洲的那两个可怜人又怎么样了呢？
* 2017 年 1 月底发生了第一起真正的大规模 ISP 下线事件。Rogers Canada 的提供商 Hitron 非常粗心地推送了一个在 2323 端口上监听的无验证的 root shell（这可能是一个他们忘记关闭的 debug 接口）。这个惊天的失误很快被 Mirai 的僵尸网络所发现，造成大量设备瘫痪。
* 在 2017 年 2 月，我注意到 Mirai 在这一年里的第一次扩张，Netcore/Netis 以及 Broadcom 的基于 CLI （命令行接口）的调制解调器都遭受了攻击。BCM CLI 后来成为了 Mirai 在 2017 年的主要战场，黑客们和我自己都在这一年的余下时间里花大量时间寻找无数 ISP 和设备制造商设置的默认密码。前面代码中的“broadcom” 载荷也许看上去有点奇怪，但它们是统计角度上最可能禁用那些大量的有问题的 BCM CLI 固件的序列。
* 在 2017 年 3 月，我大幅提升了我的僵尸网络的节点数量并开始加入更多的网络载荷。这是为了应对包括 Imeij、Amnesia 和 Persirai 在内的僵尸网络的威胁。大规模地禁用这些被入侵的设备也带来了新的一些问题。比如在 Avtech 和 Wificam 设备所泄露的登录信息当中，有一些用户名和密码非常像是用于机场和其他重要设施的，而英国政府官员大概在 2017 年 4 月 1 日关于针对机场和核设施的“实际存在的网络威胁”做出过警告。哎呀。
* 这种更加激进的扫描还引起了民间安全研究者的注意，安全公司 Radware 在 2017 年 4 月 6 日发表了一篇关于我的项目的文章。这个公司把它叫做“BrickerBot”。显然，如果我要继续增加我的物联网防御措施的规模，我必须想出更好的网络映射与检测方法来应对蜜罐或者其他有风险的目标。
* 2017 年 4 月 11 日左右的时候发生了一件非常不寻常的事情。一开始这看上去和许多其他的 ISP 下线事件相似，一个叫 Sierra Tel 的半本地 ISP 在一些 Zyxel 设备上使用了默认的 telnet 用户名密码 supervisor/zyad1234。一个 Mirai 运行器发现了这些有漏洞的设备，我的僵尸网络紧随其后，2017 年精彩绝伦的 BCM CLI 战争又开启了新的一场战斗。这场战斗并没有持续很久。它本来会和 2017 年的其他数百起 ISP 下线事件一样，如果不是在尘埃落定之后发生的那件非常不寻常的事情的话。令人惊奇的是，这家 ISP 并没有试着把这次网络中断掩盖成某种网络故障、电力超额或错误的固件升级。他们完全没有对客户说谎。相反，他们很快发表了新闻公告，说他们的调制解调器有漏洞，这让他们的客户们得以评估自己可能遭受的风险。这家全世界最诚实的 ISP 为他们值得赞扬的公开行为而收获了什么呢？悲哀的是，它得到的只是批评和不好的名声。这依然是我记忆中最令人沮丧的“为什么我们得不到好东西”的例子，这很有可能也是为什么 99% 的安全错误都被掩盖而真正的受害者被蒙在鼓里的最主要原因。太多时候，“有责任心的信息公开”会直接变成“粉饰太平”的委婉说法。
* 在 2017 年 4 月 14 日，国土安全部关于“BrickerBot 对物联网的威胁”做出了警告，我自己的政府把我作为一个网络威胁这件事让我觉得他们很不公平而且目光短浅。跟我相比，对美国人民威胁最大的难道不应该是那些部署缺乏安全性的网络设备的提供商和贩卖不成熟的安全方案的物联网设备制造商吗？如果没有我，数以百万计的人们可能还在用被入侵的设备和网络来处理银行业务和其他需要保密的交易。如果国土安全部里有人读到这篇文章，我强烈建议你重新考虑一下保护国家和公民究竟是什么意思。
* 在 2017 年 4 月底，我花了一些时间改进我的 TR069/64 攻击方法，然后在 2017 年 5 月初，一个叫 Wordfence 的公司（现在叫 Defiant）报道称一个曾给 Wordpress 网站造成威胁的基于入侵 TR069 的僵尸网络很明显地衰减了。值得注意的是，同一个僵尸网络在几星期后使用了一个不同的入侵方式暂时回归了（不过这最终也同样被化解了）。
* 在 2017 年 5 月，主机托管公司 Akamai 在它的 2017 年第一季度互联网现状报告中写道，相比于 2016 年第一季度，大型（超过 100 Gbps）DDoS 攻击数减少了 89%，而总体 DDoS 攻击数减少了 30%。鉴于大型 DDoS 攻击是 Mirai 的主要手段，我觉得这给这些月来我在物联网领域的辛苦劳动提供了实际的支持。
* 在夏天我持续地改进我的入侵技术军火库，然后在 7 月底我针对亚太互联网络信息中心（APNIC）的 ISP 进行了一些测试。测试结果非常令人吃惊。造成的影响之一是数十万的 BSNL 和 MTNL 调制解调器被禁用，而这次中断事故在印度成为了头条新闻。考虑到当时在印度和中国之间持续升级的地缘政治压力，我觉得这个事故有很大的风险会被归咎于中国所为，于是我很罕见地决定公开承认是我所做。Catalin，我很抱歉你在报道这条新闻之后突然被迫放的“两天的假期”。
* 在处理过亚太互联网络信息中心（APNIC）和非洲互联网络信息中心（AfriNIC）的之后，在 2017 年 8 月 9 日我又针对拉丁美洲与加勒比地区互联网络信息中心（LACNIC）进行了大规模的清理，给这个大洲的许多提供商造成了问题。在数百万的 Movilnet 的手机用户失去连接之后，这次攻击在委内瑞拉被大幅报道。虽然我个人反对政府监管互联网，委内瑞拉的这次情况值得注意。许多拉美与加勒比地区的提供商与网络曾在我的僵尸网络的持续调节之下连续数个月逐渐衰弱，但委内瑞拉的提供商很快加强了他们的网络防护并确保了他们的网络设施的安全。我认为这是由于委内瑞拉相比于该地区的其他国家来说进行了更具侵入性的深度包检测。值得思考一下。
* F5 实验室在 2017 年 8 月发布了一个题为“狩猎物联网：僵尸物联网的崛起”的报告，研究者们在其中对近期 telnet 活动的平静表达了困惑。研究者们猜测这种活动的减少也许证实了一个或多个非常大型的网络武器正在成型（我想这大概确实是真的）。这篇报告是在我印象中对我的项目的规模最准确的评估，但神奇的是，这些研究者们什么都推断不出来，尽管他们把所有相关的线索都集中到了一页纸上。
* 2017 年 8 月，Akamai 的 2017 年第二季度互联网现状报告宣布这是三年以来首个该提供商没有发现任何大规模（超过 100 Gbps）攻击的季度，而且 DDoS 攻击总数相比 2017 年第一季度减少了 28%。这看上去给我的清理工作提供了更多的支持。这个出奇的好消息被主流媒体所完全忽视了，这些媒体有着“流血的才是好新闻”的心态，即使是在信息安全领域。这是我们为什么不能得到好东西的又一个原因。
* 在 CVE-2017-7921 和 7923 于 2017 年 9 月公布之后，我决定更密切地关注海康威视公司的设备，然后我惊恐地发现有一个黑客们还没有发现的方法可以用来入侵有漏洞的固件。于是我在 9 月中旬开启了一个全球范围的清理行动。超过一百万台硬盘录像机和摄像机（主要是海康威视和大华出品）在三周内被禁用，然后包括 IPVM.com 在内的媒体为这些攻击写了多篇报道。大华和海康威视在新闻公告中提到或暗示了这些攻击。大量的设备总算得到了固件升级。看到这次清理活动造成的困惑，我决定给这些闭路电视制造商写一篇[简短的总结][3]（请原谅在这个粘贴板网站上的不和谐的语言）。这令人震惊的有漏洞而且在关键的安全补丁发布之后仍然在线的设备数量应该能够唤醒所有人，让他们知道现今的物联网补丁升级过程有多么无力。
* 2017 年 9 月 28 日左右，Verisign 发表了报告称 2017 年第二季度的 DDoS 攻击数相比第一季度减少了 55%，而且攻击峰值大幅减少了 81%。
* 2017 年 11 月 23 日，CDN 供应商 Cloudflare 报道称“近几个月来，Cloudflare 看到试图用垃圾流量挤满我们的网络的简单进攻尝试有了大幅减少”。Cloudflare 推测这可能和他们的政策变化有一定关系，但这些减少也和物联网清理行动有着明显的重合。
* 2017 年 11 月底，Akamai 的 2017 年第三季度互联网现状报告称 DDoS 攻击数较前一季度小幅增加了 8%。虽然这相比 2016 年的第三季度已经减少了很多，但这次小幅上涨提醒我们危险仍然存在。
* 作为潜在危险的更进一步的提醒，一个叫做“Satori”的新的 Mirai 变种于 2017 年 11 月至 12 月开始冒头。这个僵尸网络仅仅通过一个 0-day 漏洞而达成的增长速度非常值得注意。这起事件凸显了互联网的危险现状，以及我们为什么距离大规模的事故只差一两起物联网入侵。当下一次威胁发生而且没人阻止的时候，会发生什么？Sinkholing 和其他的白帽或“合法”的缓解措施在 2018 年不会有效，就像它们在 2016 年也不曾有效一样。也许未来各国政府可以合作创建一个国际范围的反黑客特别部队来应对特别严重的会影响互联网存续的威胁，但我并不抱太大期望。
* 在年末出现了一些危言耸听的新闻报道，有关被一个被称作“Reaper”和“IoTroop”的新的僵尸网络。我知道你们中有些人最终会去嘲笑那些把它的规模估算为一两百万的人，但你们应该理解这些网络安全研究者们对网络上发生的事情以及不由他们掌控的硬件的事情都是一知半解。实际来说，研究者们不可能知道或甚至猜测到大部分有漏洞的设备在僵尸网络出现时已经被禁用了。给“Reaper”一两个新的未经处理的 0-day 漏洞的话，它就会变得和我们最担心的事情一样可怕。

### --[ 3 临别赠言

我很抱歉把你们留在这种境况当中，但我的人身安全受到的威胁已经不允许我再继续下去。我树了很多敌人。如果你想要帮忙，请看前面列举的该做的事情。祝你好运。

也会有人批评我，说我不负责任，但这完全找错了重点。真正的重点是如果一个像我一样没有黑客背景的人可以做到我所做到的事情，那么一个比我厉害的人可以在 2017 年对互联网做比这要可怕太多的事情。我并不是问题本身，我也不是来遵循任何人制定的规则的。我只是报信的人。你越早意识到这点越好。

-Dr Cyborkian 又名 janit0r，“病入膏肓”的设备的调节者。

--------------------------------------------------------------------------------

via：https://ghostbin.com/paste/q2vq2

作者：janit0r
译者：[yixunx](https://github.com/yixunx)
校对：[wxy](https://github.com/wxy)

本文由 [LCTT](https://github.com/LCTT/TranslateProject) 原创编译，
[Linux中国](https://linux.cn/) 荣誉推出

[1]:https://www.telecompaper.com/news/venezuelan-operators-hit-by-unprecedented-cyberattack--1208384
[2]:https://github.com/JeremyNGalloway/mod_plaintext.py
[3]:http://depastedihrn3jtw.onion.link/show.php?md5=62d1d87f67a8bf485d43a05ec32b1e6f