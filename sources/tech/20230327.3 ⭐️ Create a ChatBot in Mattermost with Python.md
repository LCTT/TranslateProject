[#]: subject: "Create a ChatBot in Mattermost with Python"
[#]: via: "https://opensource.com/article/23/3/chatbot-mattermost-python"
[#]: author: "Dr. Michael J. Garbade https://opensource.com/users/drmjg"
[#]: collector: "lkxed"
[#]: translator: "geekpi"
[#]: reviewer: " "
[#]: publisher: " "
[#]: url: " "

Create a ChatBot in Mattermost with Python
======

ChatOps is a collaboration model that connects people, processes, tools, and automation into a transparent workflow. [Mattermost][1] is an open source, self-hosted messaging platform that enables organizations to communicate securely, effectively, and efficiently. It's a great [open source alternative][2] to Slack, Discord, and other proprietary messaging platforms. This article outlines the steps to create a ChatOps bot on Mattermost, including the necessary code examples and explanations.

### Prerequisites

Before starting, ensure that you have access to a Mattermost server, have [Python installed][3], and have installed the Mattermost Python driver [using pip][4].

### Create a bot account on Mattermost

To create a bot account, access the Mattermost System Console, and add a bot account with appropriate access permissions. Retrieve the bot's username and password for use in the Python script.

### Set up the Mattermost Python driver

Install the Mattermost Python driver using `pip`, and import it in the Python script. Create a new driver instance and log in to the Mattermost server.

### Create the ChatOps bot in Python

Create a new Python script, define the necessary libraries to be imported, and implement the bot's functionality using the Mattermost driver's API. Write code to handle messages, commands, and other events, and use the Mattermost driver's API methods to send messages and notifications to channels and users. Finally, debug and test the ChatOps bot.

### Example of ChatOps bot code

Here is an example Python code for a simple ChatOps bot that responds to a user's message:

```
from mattermostdriver import Driver

bot_username = 'bot_username'
bot_password = 'bot_password'
server_url = 'https://your.mattermost.server.url'

def main():
    driver = Driver({'url': server_url, 'login_id': bot_username, 'password': bot_password, 'scheme': 'https'})
    driver.login()
    team = driver.teams.get_team_by_name('team_name')
    channel = driver.channels.get_channel_by_name(team['id'], 'channel_name')

    @driver.on('message')
    def handle_message(post, **kwargs):
        if post['message'] == 'hello':
            driver.posts.create_post({
                'channel_id': post['channel_id'],
                'message': 'Hi there!'
            })

    driver.init_websocket()

if __name__ == '__main__':
    main()
```

### Add features

Once you've created a basic ChatOps bot on Mattermost, you can add more features to extend its functionality. Here are the steps:

- **Determine the feature you want to add**: Before writing the code, you must determine the feature to add to your ChatOps bot. This can be anything from sending notifications to integrating with third-party tools.
- **Write the code**: Once you have determined the feature you want to add, you can start writing the code. The code will depend on the feature you add, but you can use the Mattermost Python driver to interact with the Mattermost API and implement the feature.
- **Test the code**: After writing the code, it's important to test it to ensure that it works as expected. Before deploying it to your production server, you can test the code on a development server or in a test channel.
- **Deploy the code**: Once you have tested it and it works as expected, you can deploy it to your production server. Follow your organization's deployment process and ensure the new code doesn't break any existing functionality.
- **Document the new feature**: It's important to document the new feature you have added to your ChatOps bot. This will make it easier for other team members to use the bot and understand its capabilities.

One example of a ChatOps Bot feature could be integrating with a third-party tool and providing status updates on certain tasks.

```
from mattermostdriver import Driver
import requests

bot_username = 'bot_username'
bot_password = 'bot_password'
server_url = 'https://your.mattermost.server.url'

def main():
    driver = Driver({'url': server_url, 'login_id': bot_username, 'password': bot_password, 'scheme': 'https'})
    driver.login()
    team = driver.teams.get_team_by_name('team_name')
    channel = driver.channels.get_channel_by_name(team['id'], 'channel_name')

    @driver.on('message')
    def handle_message(post, **kwargs):
        if post['message'] == 'status':
            # Make a request to the third-party tool API to get the status
            response = requests.get('https://api.thirdpartytool.com/status')
            if response.status_code == 200:
                status = response.json()['status']
                driver.posts.create_post({
                    'channel_id': post['channel_id'],
                    'message': f'The status is {status}'
                })
            else:
                driver.posts.create_post({
                    'channel_id': post['channel_id'],
                    'message': 'Failed to get status'
                })

    driver.init_websocket()

if __name__ == '__main__':
    main()
```

In this example, the ChatOps bot listens for the command "status" and makes a request to a third-party tool API to get the current status. It then posts the status update in the Mattermost channel where the command was issued. This allows team members to quickly get updates on the status of the task without having to leave the chat platform.

### Open source ChatOps

In summary, creating a ChatOps bot on Mattermost is a simple process that can bring numerous benefits to your organization's communication and workflow. This article has provided a step-by-step breakdown and code examples to help you get started on creating your bot and even customize it by adding new features. Now that you know the basics, you can further explore ChatOps and Mattermost to optimize your team's collaboration and productivity.

--------------------------------------------------------------------------------

via: https://opensource.com/article/23/3/chatbot-mattermost-python

作者：[Dr. Michael J. Garbade][a]
选题：[lkxed][b]
译者：[译者ID](https://github.com/译者ID)
校对：[校对者ID](https://github.com/校对者ID)

本文由 [LCTT](https://github.com/LCTT/TranslateProject) 原创编译，[Linux中国](https://linux.cn/) 荣誉推出

[a]: https://opensource.com/users/drmjg
[b]: https://github.com/lkxed/
[1]: https://mattermost.com/
[2]: https://opensource.com/alternatives/slack
[3]: https://opensource.com/article/17/10/python-101
[4]: https://opensource.com/article/20/3/pip-linux-mac-windows