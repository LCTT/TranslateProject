[#]: subject: "Linux Kernel 6.4 RC1 Released with Intel LAM, More Rust Code"
[#]: via: "https://www.debugpoint.com/linux-kernel-6-4-rc1/"
[#]: author: "Arindam https://www.debugpoint.com/author/admin1/"
[#]: collector: "lkxed"
[#]: translator: " "
[#]: reviewer: " "
[#]: publisher: " "
[#]: url: " "

Linux Kernel 6.4 RC1 Released with Intel LAM, More Rust Code
======

**Linus Torvalds releases Linux Kernel 6.4 RC1 for everyone to test, which brings regular updates, more Rust code and changes across modules.**

The merge window for Linux Kernel 6.4 is now closed, followed by the two weeks of merge window since Kernel 6.3 release. While announcing, Linus mentioned that it is a fairly normal merge cycle with usual changes across Kernel, with AMD dominating the space.

> But if you ignore those two “massive, but uninteresting” parts of the changes, everything else looks fairly normal. Lots of development all over, with “that’s interesting” mainly depending on the reader. Drivers, architecture updates, filesystems, networking, memory management – there’s a bit of everything.The one feature that didn’t make it was the x86 shadow stack code. That side was probably a bit unlucky, in that it came in as I was looking at x86 issues anyway, and so I looked at it quite a bit, and had enough reservations that I asked for a couple of fairly big re-organizations.[Linus][1]

That being said, let’s take a look at what’s new in Linux Kernel 6.4.

### Linux Kernel 6.4 (RC1): Top Updates

#### CPU: AMD and Intel

After some significant amount of development, AMD [introduces][2] the 5-level page support in Kernel. This is part of the AMD IOMMU driver and will be enabled if the processors support it. The use of 5-level page tables is significant because it greatly increases the amount of virtual and physical address space, allowing for up to 4 PiB of physical memory addresses to be addressed. The only downside is that page table walks take longer due to the extra level.

AMD’s P-State driver extension, Guided Autonomous Mode, has been [submitted][3] to the Linux 6.4 kernel. Work for P-state drivers was ongoing for a couple of months which is related to the performance or power. Guided Autonomous Mode lets the operating system determine the minimum and maximum frequencies/performance levels and then allows the platform firmware to choose an operating frequency within that range. This feature will likely improve performance and power efficiency for AMD Ryzen and EPYC servers. You can activate it using amd_pstate=guided kernel option in 6.4 until it is enabled by default.

In addition to the above, other AMD highlight features include – AMD CDX bus updates for APU and FPGA interface and AMD SEV-SNP vTOM guest support on Microsoft Hyper-V.

Intel’s Linear Address Masking (LAM) feature, which allows user-space to store metadata within some bits of pointers without masking it out before use, has been [merged][4] with the Linux 6.4 kernel. LAM is similar to Arm’s Top Byte Ignore (TBI) and has applications in virtual machines, profiling and similar areas.

Intel’s Thunder Bay, which was gossiped to feature a mix of Intel x86 cores and Movidius VPU cores, has been confirmed as cancelled and code has been dropped from mainline Kernel starting with 6.4.

#### CPU: SoC and ARM

The latest Linux 6.4 kernel update has [added][5] DeviceTree files for the Apple M2 SoC, which is used in the current MacBook Air, MacBook Pro, and Mac Mini systems. Although the support is similar to the Apple M1, there are still some limitations, such as no working display output yet for the Apple M2 Mac Mini, and keyboard and trackpad support for the new Apple laptops not yet being functional.

Furthermore, [other SoC updates][6] in this kernel include:

- Allwinner T113-s
- StarFive JH7110 SoC
- Qualcomm IPQ5332 and IPQ9574
- Qualcomm sa8775p
- New Allwinner f1c200s boards
- AM625 BeaglePlay
- Helio X10 SoC

#### GPU

Intel is yet to announce the release of the Meteor Lake lineup, however, more work continues to come in the mainline Kernel. Also, a few changes for AMD’s Next-Gen CDNA accelerators with multiple chipsets were brought up.

AMDGPU kernel graphics driver changes have been [submitted][7] for this version, with a focus on power-related additions for Van Gogh APUs. SteamOS will be able to intelligently manage the thermal handling of the APU graphics.

#### Storage and file systems

[Huawei’s EROFS][8] which is a read-only file system for Android devices sees more [improvements][9] in this release considering upcoming traction and use cases for containers.

The Linux 6.4 kernel brings significant [updates][10] to the Btrfs and Flash-Friendly File-System (F2FS) drivers. Btrfs updates include performance improvements for directory logging that can lead to a 4x lower fsync time. The I/O has been cleaned up and rewritten making it more faster.

The F2FS updates for Linux 6.4 caters to code refactoring and a few bug fixes.

The famous NTFS3 driver, which mainlined last year, sees some [bug fixes and performance improvements][11].

#### Rust updates

Continuing with the Rust framework updates, Kernel 6.4 adds pin-init API to prevent unsafe Rust code in Kernel, updates to sync module, new ioctl module and [more.][12]

#### Few Apple related changes

The mainline Linux 6.4 kernel [brings][13] the “pwm-apple” Apple PWM controller driver, which enables control of the keyboard backlight and other functions on Apple SoC devices. The driver has been added to improve functionality for Apple M1 and M2 MacBook users. The DeviceTree additions for the PWM controller and keyboard backlight bindings have been added to the T8103 configuration for Apple M1 MacBooks, the T600x configuration for Apple M1 Pro/Max MacBook Pro laptops, and the T8112 DT for initial Apple M2 MacBook support. Asahi Linux users already have this update as part of their custom Kernel.

So, that’s about the key changes. As always, the entire changelog is huge for the release and you should get a release diff after the final release.

### Download Linux Kernel 6.4 RC1 source

You can download the RC source tree from the following [page][14].

| - | - | - | - | - | - | - |
| :- | :- | :- | :- | :- | :- | :- |
| mainline: | **6.4-rc1** | 2023-05-07 | [[tarball][15]] | [[patch][16]] | [[view diff][17]] | [[browse][18]] |

If you are running benchmarks, testing new hardware and finding issues, report to the Kernel mailing list.

Finally, the Linux Kernel 6.4 is expected to be released around June end/July 2023 timelines. The Q4 2023 Linux distribution releases – Fedora 39, and Ubuntu 23.10 may get this version.

Please test and report issues if you find any.

--------------------------------------------------------------------------------

via: https://www.debugpoint.com/linux-kernel-6-4-rc1/

作者：[Arindam][a]
选题：[lkxed][b]
译者：[译者ID](https://github.com/译者ID)
校对：[校对者ID](https://github.com/校对者ID)

本文由 [LCTT](https://github.com/LCTT/TranslateProject) 原创编译，[Linux中国](https://linux.cn/) 荣誉推出

[a]: https://www.debugpoint.com/author/admin1/
[b]: https://github.com/lkxed/
[1]: https://lore.kernel.org/lkml/CAHk-=wiUxm-NZ1si8dXWVTTJ9n3c+1SRTC0V+Lk7hOE4bDVwJQ@mail.gmail.com/T/#u
[2]: https://lore.kernel.org/lkml/ZE5NR5Ml8I2%2FZe0f@8bytes.org/T/#u
[3]: https://lore.kernel.org/lkml/CAJZ5v0htGCiRkSjnOGoQbViuRz==gAN2hwuFtrFK+Y8eNGy=ZA@mail.gmail.com/
[4]: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=22b8cc3e78f5448b4c5df00303817a9137cd663f
[5]: https://lore.kernel.org/lkml/7263df01-aebc-2db5-f074-4805e0ae9fbc@marcan.st/
[6]: https://lore.kernel.org/lkml/bbd25997-173e-4c3b-930c-65c6232908e3@app.fastmail.com/
[7]: https://lore.kernel.org/dri-devel/20230317164416.138340-1-alexander.deucher@amd.com/
[8]: https://consumer.huawei.com/en/community/details/EMUI-Technology-behind-EROFS-File-System/topicId_19791/
[9]: https://lore.kernel.org/lkml/8be37b4c-5a87-1c10-b0e6-99284e6fd4ca@linux.alibaba.com/
[10]: https://lore.kernel.org/lkml/ZEgdmJWhJX9NJ0fG@google.com/
[11]: https://lore.kernel.org/lkml/f949c754-6d38-af12-fa83-176e9971132e@paragon-software.com/
[12]: https://lore.kernel.org/lkml/20230429012119.421536-1-ojeda@kernel.org/
[13]: https://lore.kernel.org/lkml/d0862463-acb3-ce83-6493-281a833ec87e@marcan.st/T/#u
[14]: https://www.kernel.org/
[15]: https://git.kernel.org/torvalds/t/linux-6.4-rc1.tar.gz
[16]: https://git.kernel.org/torvalds/p/v6.4-rc1/v6.3
[17]: https://git.kernel.org/torvalds/ds/v6.4-rc1/v6.3
[18]: https://git.kernel.org/torvalds/h/v6.4-rc1
