解密"top"
================================================================================
当对服务器的性能好奇时，我第一个想到的是"top"命令。top不是最好的，它不是一个长期的快照，但是它提供了服务器的一个像样的时间点的快照，并且尝试回答了问题"现在在发生什么？"。不幸地，top的输出很容易被误解如果你没有很好地理解数据显示的不同域。

我不会完整解读top命令的[man page][2]，当你和时间和意愿时，它一直在那等着你。我想要做的是指出一些我如何得到系统的快速概况的几个要点，并希望得到我接下来该怎么做。top是我在故障排除时的第一站，但这很少是我唯一的一站。

[![](http://farm4.staticflickr.com/3827/10847969205_c1b75f9fa2_m.jpg)][1]

top命令我第一个看的是平均负载(load average),它在右上角的屏幕上。平均负载的计算是基于统计搜集的数量，但是可以通常地认为是CPU被请求工作的数量。如果你的机器有一个单核CPU，那么平均负载是1就意味着机器是被完全加载的并且有充分的能力去完成在采样时间内的任务。同样地，如果平均负载是2，那单核的CPU是超载的，并需要2个可用内核去完成在同样采样时间内被要求完成的任务。随着8、16、32核的发售，我会在考虑平均负载的时候再三考虑。如果我需要去检测，我会在top里按了"1"，这会列出所有CPU核列表，这样我就可以得到一个快速计数用于比较。

我检查的第二项是第一步列出来的，在第9列，标记着"%CPU"。这一列的解释是新奇的:

> 任务共享上次屏幕刷新后的CPU运行时间，以完全的CPU时间百分比表示。在一个完全SMP环境中，如果'Irix mode'是关闭的，top会在'Solaris mode'下操作，这里一个任务的cpu使用率将被全部的CPU分割。你可以用'I'这个交互命令触发Irix或Solaris模式。

一点也不清楚，是么？这里要记住的主要意思是如果单个进程由于某个原因或者其他因素占用率升高，那么他很有可能会以%CPU很高的数字显示在top的第一行。

我下一个看到的区域是"Cpu(s):"这一行，这头部的中间。特别地，我对%us、sy%、%id、和%wa感兴趣，它们分别是用户进程、系统进程、空闲时间和CPU用于等待I/O流执行的时间比例。这个百分比应该接近于0，高于5%时需要密切关注。

最后，我想要检测系统up时间，这显示在左上角。如果我对一台服务器有疑问，并且这台服务器最近重启过，这里或许有一个关联，或许是一个守护进程没有启动。

这些测试只需要几秒。如果我只是观察，我可能让top运行几分钟并观察进程、CPU和负载，但是通常地我很快地进入和退出top。top是给你一个系统健康概况的那些奇妙系统管理员工具之一，并允许你快速诊断潜在的问题。

--------------------------------------------------------------------------------

via: http://ostatic.com/blog/deciphering-top

译者：[geekpi](https://github.com/geekpi) 校对：[校对者ID](https://github.com/校对者ID)

本文由 [LCTT](https://github.com/LCTT/TranslateProject) 原创翻译，[Linux中国](http://linux.cn/) 荣誉推出

[1]:http://www.flickr.com/photos/51724787@N06/10847969205/
[2]:http://www.linuxmanpages.com/man1/top1.php